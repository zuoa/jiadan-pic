<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šä¼ æµ‹è¯•</title>
</head>
<body>
    <h1>ä¸Šä¼ åŠŸèƒ½æµ‹è¯•</h1>
    
    <form id="uploadForm">
        <div>
            <label for="fileInput">é€‰æ‹©å›¾ç‰‡æ–‡ä»¶:</label>
            <input type="file" id="fileInput" accept="image/*" required>
        </div>
        <div>
            <label for="titleInput">æ ‡é¢˜:</label>
            <input type="text" id="titleInput" value="æµ‹è¯•ç…§ç‰‡">
        </div>
        <div>
            <label for="descInput">æè¿°:</label>
            <textarea id="descInput">è¿™æ˜¯ä¸€å¼ æµ‹è¯•ç…§ç‰‡</textarea>
        </div>
        <div>
            <label for="locationInput">ä½ç½®:</label>
            <input type="text" id="locationInput" value="æµ‹è¯•åœ°ç‚¹">
        </div>
        <div>
            <label for="publicInput">å…¬å¼€:</label>
            <input type="checkbox" id="publicInput">
        </div>
        <button type="submit">ä¸Šä¼ </button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('è¯·é€‰æ‹©æ–‡ä»¶');
                return;
            }

            console.log('ğŸ“ é€‰æ‹©çš„æ–‡ä»¶:', {
                name: file.name,
                type: file.type,
                size: file.size,
                lastModified: file.lastModified
            });

            const formData = new FormData();
            formData.append('file', file, file.name);
            formData.append('title', document.getElementById('titleInput').value);
            formData.append('description', document.getElementById('descInput').value);
            formData.append('date', new Date().toISOString().split('T')[0]);
            formData.append('location', document.getElementById('locationInput').value);
            formData.append('is_public', document.getElementById('publicInput').checked.toString());

            console.log('ğŸ“¤ FormDataå†…å®¹:');
            for (let [key, value] of formData.entries()) {
                console.log(`  ${key}:`, value);
            }

            try {
                const response = await fetch('http://localhost:8000/api/photos/upload', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer your-token-here' // éœ€è¦æ›¿æ¢ä¸ºçœŸå®token
                    },
                    body: formData
                });

                const result = await response.json();
                console.log('ğŸ“¨ å“åº”:', result);
                
                document.getElementById('result').innerHTML = `
                    <h3>å“åº”ç»“æœ:</h3>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('âŒ ä¸Šä¼ å¤±è´¥:', error);
                document.getElementById('result').innerHTML = `
                    <h3>é”™è¯¯:</h3>
                    <pre>${error.message}</pre>
                `;
            }
        });
    </script>
</body>
</html> 